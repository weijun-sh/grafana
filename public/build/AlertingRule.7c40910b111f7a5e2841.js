"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4679],{"./public/app/features/alerting/unified/RuleViewer.tsx":(e,t,s)=>{s.r(t),s.d(t,{RuleViewer:()=>Z,default:()=>W});var a=s("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),r=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),n=s("./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useObservable.js"),i=s("./packages/grafana-data/src/index.ts"),c=s("./packages/grafana-ui/src/index.ts"),u=s("./public/app/features/alerting/unified/components/AlertLabels.tsx"),o=s("./public/app/features/alerting/unified/components/DetailsField.tsx"),l=s("./public/app/features/alerting/unified/components/rule-viewer/RuleViewerLayout.tsx"),d=s("./.yarn/__virtual__/react-virtualized-auto-sizer-virtual-b5ab366cb0/0/cache/react-virtualized-auto-sizer-npm-1.0.6-50869b8392-81270e9d32.zip/node_modules/react-virtualized-auto-sizer/dist/index.esm.js"),p=s("./packages/grafana-runtime/src/index.ts"),f=s("./public/app/features/expressions/guards.ts"),m=s("./public/app/types/index.ts"),g=s("./public/app/features/alerting/unified/utils/constants.ts"),h=s("./public/app/features/alerting/unified/components/Authorize.tsx"),b=s("./public/app/features/alerting/unified/components/PanelPluginsButtonGroup.tsx"),x=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const j=["refId"];var v;const y=4;function S(e){var t;const s=(0,c.useTheme2)(),a=(0,c.useStyles2)(_),{data:n,query:u,onChangeQuery:o}=e,l=(0,f.j)(u.model)?g.Fe:g.GC,[S,w]=(0,r.useState)(l),R=(0,p.getDataSourceSrv)().getInstanceSettings(u.datasourceUid),k=u.relativeTimeRange,[z,C]=(0,r.useState)({frameIndex:0,showHeader:!0}),$=(0,r.useCallback)(e=>{const t=(0,i.dateTime)().unix()-e.unix();if(k){const e=k.from-k.to;o(Object.assign({},u,{relativeTimeRange:{from:t+e,to:t}}))}},[o,u,k]),q=(0,r.useCallback)(e=>0===e?(0,i.dateTime)():(0,i.dateTime)().subtract(e,"seconds"),[]);return n?R?(0,x.jsx)("div",{className:a.content,children:(0,x.jsx)(d.Z,{children:e=>{let{width:r,height:o}=e;return(0,x.jsxs)("div",{style:{width:r,height:o},children:[(0,x.jsxs)("div",{className:a.header,children:[(0,x.jsxs)("div",{children:[`Query ${u.refId}`,(0,x.jsxs)("span",{className:a.dataSource,children:["(",R.name,")"]})]}),(0,x.jsxs)("div",{className:a.actions,children:[!(0,f.j)(u.model)&&k?(0,x.jsx)(c.DateTimePicker,{date:q(k.to),onChange:$,maxDate:new Date}):null,t||(t=(0,x.jsx)(b.j,{onChange:w,value:S,size:"md"})),(0,x.jsx)(h.q,{actions:[m.bW.DataSourcesExplore],children:!(0,f.j)(u.model)&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:a.spacing}),(0,x.jsx)(c.LinkButton,{size:"md",variant:"secondary",icon:"compass",target:"_blank",href:function(e,t){const{name:s}=e,a=function(e,t){if(null==e)return{};var s,a,r={},n=Object.keys(e);for(a=0;a<n.length;a++)s=n[a],t.indexOf(s)>=0||(r[s]=e[s]);return r}(t.model,j),r=Object.assign({},a,{datasource:s});return i.urlUtil.renderUrl(`${p.config.appSubUrl}/explore`,{left:JSON.stringify(["now-1h","now",s,r])})}(R,u),children:"View in Explore"})]})})]})]}),(0,x.jsx)(p.PanelRenderer,{height:o-s.spacing.gridSize*y,width:r,data:n,pluginId:S,title:"",onOptionsChange:C,options:z})]})}})}):(0,x.jsxs)("div",{className:a.content,children:[v||(v=(0,x.jsx)(c.Alert,{title:"Could not find datasource for query"})),(0,x.jsx)(c.CodeEditor,{width:"100%",height:"250px",language:"json",showLineNumbers:!1,showMiniMap:!1,value:JSON.stringify(u,null,"\t"),readOnly:!0})]}):null}const _=e=>({content:a.css`
      width: 100%;
      height: 250px;
    `,header:a.css`
      height: ${e.spacing(y)};
      display: flex;
      align-items: center;
      justify-content: space-between;
      white-space: nowrap;
    `,refId:a.css`
      font-weight: ${e.typography.fontWeightMedium};
      color: ${e.colors.text.link};
      overflow: hidden;
    `,dataSource:a.css`
      margin-left: ${e.spacing(1)};
      font-style: italic;
      color: ${e.colors.text.secondary};
    `,actions:a.css`
      display: flex;
      align-items: center;
    `,spacing:a.css`
      padding: ${e.spacing(0,1,0,0)};
    `,errorMessage:a.css`
      white-space: pre-wrap;
    `});var w=s("./public/app/features/alerting/unified/components/rules/RuleDetailsActionButtons.tsx"),R=s("./public/app/features/alerting/unified/components/rules/RuleDetailsAnnotations.tsx"),k=s("./public/app/features/alerting/unified/components/rules/RuleDetailsDataSources.tsx"),z=s("./public/app/features/alerting/unified/components/rules/RuleDetailsExpression.tsx");const C=e=>{var t;let{group:s}=e;const a=null!==(t=s.source_tenants)&&void 0!==t?t:[];return(0,x.jsx)(o.C,{label:"Tenant sources",children:(0,x.jsx)(x.Fragment,{children:a.map(e=>(0,x.jsx)("div",{children:e},e))})})};var $=s("./public/app/features/alerting/unified/components/rules/RuleDetailsMatchingInstances.tsx"),q=s("./public/app/features/alerting/unified/components/rules/RuleHealth.tsx"),I=s("./public/app/features/alerting/unified/components/rules/RuleState.tsx"),O=s("./public/app/features/alerting/unified/hooks/useAlertQueriesStatus.ts"),T=s("./public/app/features/alerting/unified/hooks/useCombinedRule.ts"),D=s("./public/app/features/alerting/unified/state/AlertingQueryRunner.ts"),N=s("./public/app/features/alerting/unified/utils/datasource.ts"),L=s("./public/app/features/alerting/unified/utils/rules.ts");function A(e){if(!e)return[];const{namespace:t,rulerRule:s}=e,{rulesSource:a}=t;if((0,N.HY)(a)&&(0,L.Pc)(s))return s.grafana_alert.data;if((0,N.jq)(a)){const t=function(e,t){switch(e.type){case"prometheus":case"loki":{const e={refId:"A",expr:t.query};return e}default:throw new Error(`Query for datasource type ${e.type} is currently not supported by cloud alert rules.`)}}(a,e);return[{refId:t.refId,datasourceUid:a.uid,queryType:"",model:t,relativeTimeRange:{from:360,to:0}}]}return[]}var M,U,P,Q,E,B=s("./public/app/features/alerting/unified/utils/rule-id.ts");const F="Could not find data source for rule",V="Could not view rule",G="Alerting / View rule";function Z(e){let{match:t}=e;const s=(0,c.useStyles2)(H),{id:a,sourceName:d}=t.params,p=B.OA(a,!0),{loading:f,error:m,result:g}=(0,T.H)(p,d),h=(0,r.useMemo)(()=>new D.v,[]),b=(0,n.Z)(h.get()),j=(0,r.useMemo)(()=>A(g),[g]),[v,y]=(0,r.useState)([]),{allDataSourcesAvailable:_}=(0,O.S)(j),Z=(0,r.useCallback)(()=>{v.length>0&&_&&h.run(v)},[v,h,_]);(0,r.useEffect)(()=>{y(j)},[j]),(0,r.useEffect)(()=>{_&&Z()},[Z,_]),(0,r.useEffect)(()=>()=>h.destroy(),[h]);const W=(0,r.useCallback)(e=>{y(t=>t.map(t=>t.refId===e.refId?e:t))},[]);if(!d)return(0,x.jsx)(l.$,{title:G,children:(0,x.jsx)(c.Alert,{title:V,children:(0,x.jsx)("details",{className:s.errorMessage,children:F})})});const J=(0,N.o_)(d);if(f)return M||(M=(0,x.jsx)(l.$,{title:G,children:(0,x.jsx)(c.LoadingPlaceholder,{text:"Loading rule..."})}));var K;if(m||!J)return(0,x.jsx)(l.$,{title:G,children:(0,x.jsx)(c.Alert,{title:V,children:(0,x.jsxs)("details",{className:s.errorMessage,children:[null!==(K=null===m||void 0===m?void 0:m.message)&&void 0!==K?K:F,U||(U=(0,x.jsx)("br",{})),!(null===m||void 0===m||!m.stack)&&m.stack]})})});if(!g)return P||(P=(0,x.jsx)(l.$,{title:G,children:(0,x.jsx)("span",{children:"Rule could not be found."})}));const Y=Object.entries(g.annotations).filter(e=>{let[t,s]=e;return!!s.trim()}),X=(0,L.Jq)(g.group);return(0,x.jsxs)(l.$,{wrapInContent:!1,title:G,children:[X&&(Q||(Q=(0,x.jsx)(c.Alert,{severity:"info",title:"This rule is part of a federated rule group.",children:(0,x.jsxs)(c.VerticalGroup,{children:["Federated rule groups are currently an experimental feature.",(0,x.jsx)(c.Button,{fill:"text",icon:"book",children:(0,x.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:"Read documentation"})})]})}))),(0,x.jsxs)(l.l,{children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("h4",{children:[E||(E=(0,x.jsx)(c.Icon,{name:"bell",size:"lg"}))," ",g.name]}),(0,x.jsx)(I.p,{rule:g,isCreating:!1,isDeleting:!1}),(0,x.jsx)(w.f,{rule:g,rulesSource:J})]}),(0,x.jsxs)("div",{className:s.details,children:[(0,x.jsxs)("div",{className:s.leftSide,children:[g.promRule&&(0,x.jsx)(o.C,{label:"Health",horizontal:!0,children:(0,x.jsx)(q.V,{rule:g.promRule})}),!!g.labels&&!!Object.keys(g.labels).length&&(0,x.jsx)(o.C,{label:"Labels",horizontal:!0,children:(0,x.jsx)(u.s,{labels:g.labels})}),(0,x.jsx)(z.C,{rulesSource:J,rule:g,annotations:Y}),(0,x.jsx)(R.J,{annotations:Y})]}),(0,x.jsxs)("div",{className:s.rightSide,children:[(0,x.jsx)(k.C,{rule:g,rulesSource:J}),X&&(0,x.jsx)(C,{group:g.group}),(0,x.jsx)(o.C,{label:"Namespace / Group",children:`${g.namespace.name} / ${g.group.name}`})]})]}),(0,x.jsx)("div",{children:(0,x.jsx)($.M,{promRule:g.promRule})})]}),!X&&b&&Object.keys(b).length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:s.queriesTitle,children:["Query results ",(0,x.jsx)(c.PanelChromeLoadingIndicator,{loading:function(e){return!!Object.values(e).find(e=>e.state===i.LoadingState.Loading)}(b),onCancel:()=>h.cancel()})]}),(0,x.jsx)(l.l,{padding:0,children:(0,x.jsx)("div",{className:s.queries,children:v.map(e=>(0,x.jsx)("div",{className:s.query,children:(0,x.jsx)(S,{query:e,data:b&&b[e.refId],onChangeQuery:W})},e.refId))})})]}),!X&&!_&&(0,x.jsx)(c.Alert,{title:"Query not available",severity:"warning",className:s.queryWarning,children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})]})}const H=e=>({errorMessage:a.css`
      white-space: pre-wrap;
    `,queries:a.css`
      height: 100%;
      width: 100%;
    `,queriesTitle:a.css`
      padding: ${e.spacing(2,.5)};
      font-size: ${e.typography.h5.fontSize};
      font-weight: ${e.typography.fontWeightBold};
      font-family: ${e.typography.h5.fontFamily};
    `,query:a.css`
      border-bottom: 1px solid ${e.colors.border.medium};
      padding: ${e.spacing(2)};
    `,queryWarning:a.css`
      margin: ${e.spacing(4,0)};
    `,details:a.css`
      display: flex;
      flex-direction: row;
    `,leftSide:a.css`
      flex: 1;
    `,rightSide:a.css`
      padding-left: 90px;
      width: 300px;
    `}),W=(0,c.withErrorBoundary)(Z,{style:"page"})},"./public/app/features/alerting/unified/components/Authorize.tsx":(e,t,s)=>{s.d(t,{q:()=>n});s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var a=s("./public/app/core/services/context_srv.ts"),r=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const n=e=>{let{actions:t,children:s,fallback:n=!0}=e;return t.some(e=>a.Vt.hasAccess(e,n))?(0,r.jsx)(r.Fragment,{children:s}):null}},"./public/app/features/alerting/unified/components/PanelPluginsButtonGroup.tsx":(e,t,s)=>{s.d(t,{j:()=>(function(e){const{value:t,onChange:s,size:u="md"}=e,o=(0,a.useMemo)(()=>Object.values(r.config.panels).reduce((e,t)=>((function(e){switch(e){case i.GC:case i.Fe:case i.Kd:return!0;default:return!1}})(t.id)&&e.push({value:t.id,label:t.name,imgUrl:t.info.logos.small}),e),[]),[]);return(0,c.jsx)(n.RadioButtonGroup,{options:o,value:t,onChange:s,size:u})})});var a=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=s("./packages/grafana-runtime/src/index.ts"),n=s("./packages/grafana-ui/src/index.ts"),i=s("./public/app/features/alerting/unified/utils/constants.ts"),c=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js")},"./public/app/features/alerting/unified/components/rule-viewer/RuleViewerLayout.tsx":(e,t,s)=>{s.d(t,{$:()=>(function(e){const{wrapInContent:t=!0,children:s,title:a}=e,l=(0,n.useStyles2)(o);return(0,c.jsxs)(i.T,{children:[(0,c.jsx)(n.PageToolbar,{title:a,pageIcon:"bell",onGoBack:()=>r.locationService.push("/alerting/list")}),(0,c.jsx)("div",{className:l.content,children:t?(0,c.jsx)(u,Object.assign({},e)):s})]})}),l:()=>u});var a=s("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),r=(s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),s("./packages/grafana-runtime/src/index.ts")),n=s("./packages/grafana-ui/src/index.ts"),i=s("./public/app/core/components/Page/Page.tsx"),c=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");function u(e){let{children:t,padding:s=2}=e;const a=(0,n.useStyles2)(l(s));return(0,c.jsx)("div",{className:a.wrapper,children:t})}const o=e=>({content:a.css`
      margin: ${e.spacing(0,2,2)};
      max-width: ${e.breakpoints.values.xxl}px;
    `}),l=e=>t=>({wrapper:a.css`
      background: ${t.colors.background.primary};
      border: 1px solid ${t.colors.border.weak};
      border-radius: ${t.shape.borderRadius()};
      padding: ${t.spacing(e)};
    `})},"./public/app/features/alerting/unified/hooks/useAlertQueriesStatus.ts":(e,t,s)=>{s.d(t,{S:()=>(function(e){return{allDataSourcesAvailable:(0,a.useMemo)(()=>e.every(e=>Boolean((0,r.getDataSourceSrv)().getInstanceSettings(e.datasourceUid))),[e])}})});var a=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=s("./packages/grafana-runtime/src/index.ts")},"./public/app/features/alerting/unified/hooks/useCombinedRule.ts":(e,t,s)=>{s.d(t,{H:()=>(function(e,t){const s=p(t),r=(0,l.Zo)(t),n=(0,a.useMemo)(()=>{if(e&&t&&0!==r.length)for(const s of r)for(const a of s.groups)for(const s of a.rules){const a=u.Yd(t,s);if(u.Dg(a,e))return s}},[e,t,r]);return Object.assign({},s,{result:n})}),X:()=>(function(e,t){const s=p(t),r=(0,l.Zo)(t),n=(0,a.useMemo)(()=>{if(!e||!t||0===r.length)return[];const s=[];for(const t of r)for(const a of t.groups)for(const t of a.rules)t.name===e&&s.push(t);return s},[e,t,r]);return Object.assign({},s,{result:n})})});var a=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=s("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/0/cache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),n=s("./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useAsync.js"),i=s("./public/app/features/alerting/unified/state/actions.ts"),c=s("./public/app/features/alerting/unified/utils/redux.ts"),u=s("./public/app/features/alerting/unified/utils/rule-id.ts"),o=s("./public/app/features/alerting/unified/utils/rules.ts"),l=s("./public/app/features/alerting/unified/hooks/useCombinedRuleNamespaces.ts"),d=s("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts");function p(e){var t;const s=(0,r.useDispatch)(),a=(0,d._)(e=>e.promRules),c=f(e,a),u=(0,d._)(e=>e.rulerRules),l=f(e,u),{loading:p}=(0,n.Z)(async()=>{e&&await s((0,i.dn)({rulesSourceName:e}))},[s,e]);return{loading:p,error:(null!==(t=c.error)&&void 0!==t?t:(0,o.m$)(l))?void 0:l.error,dispatched:c.dispatched&&l.dispatched}}function f(e,t){if(!e)return c.oq;const s=t[e];return s||c.oq}},"./public/app/features/alerting/unified/state/AlertingQueryRunner.ts":(e,t,s)=>{s.d(t,{v:()=>(class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,d.i)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,l.getDataSourceSrv)();this.backendSrv=e,this.dataSourceSrv=t,_(this,"subject",void 0),_(this,"subscription",void 0),_(this,"lastResult",void 0),this.backendSrv=e,this.dataSourceSrv=t,this.subject=new a.t(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(e){if(0===e.length){const t=R(e,o.LoadingState.Done);return this.subject.next(t)}for(const t of e)if(!(0,p.j)(t.model)){const s=await this.dataSourceSrv.get(t.datasourceUid);if(s.filterQuery&&!s.filterQuery(t.model)){const t=R(e,o.LoadingState.Done);return this.subject.next(t)}}this.subscription=w(this.backendSrv,e).subscribe({next:e=>{const t=$(e,(e,t)=>{const s=this.lastResult[e],a=(0,g.zR)(t,s);return(0,m.C)(a,s)});this.lastResult=t,this.subject.next(this.lastResult)},error:e=>{this.lastResult=C(this.lastResult,e),this.subject.next(this.lastResult)}})}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let e=!1;const t=$(this.lastResult,(t,s)=>(s.state===o.LoadingState.Loading&&(e=!0),Object.assign({},s,{state:o.LoadingState.Done})));e&&this.subject.next(t)}destroy(){this.subject&&this.subject.complete(),this.cancel()}})});var a=s("./.yarn/cache/rxjs-npm-7.5.5-d0546b1ccb-e034f60805.zip/node_modules/rxjs/dist/esm5/internal/ReplaySubject.js"),r=s("./.yarn/cache/rxjs-npm-7.5.5-d0546b1ccb-e034f60805.zip/node_modules/rxjs/dist/esm5/internal/observable/of.js"),n=s("./.yarn/cache/rxjs-npm-7.5.5-d0546b1ccb-e034f60805.zip/node_modules/rxjs/dist/esm5/internal/operators/catchError.js"),i=s("./.yarn/cache/rxjs-npm-7.5.5-d0546b1ccb-e034f60805.zip/node_modules/rxjs/dist/esm5/internal/operators/share.js"),c=s("./.yarn/cache/rxjs-npm-7.5.5-d0546b1ccb-e034f60805.zip/node_modules/rxjs/dist/esm5/internal/operators/map.js"),u=s("./.yarn/cache/uuid-npm-8.3.2-eca0baba53-5575a8a75c.zip/node_modules/uuid/dist/esm-browser/v4.js"),o=s("./packages/grafana-data/src/index.ts"),l=s("./packages/grafana-runtime/src/index.ts"),d=s("./public/app/core/services/backend_srv.ts"),p=s("./public/app/features/expressions/guards.ts"),f=s("./public/app/features/query/state/processing/canceler.ts"),m=s("./public/app/features/query/state/processing/revision.ts"),g=s("./public/app/features/query/state/runRequest.ts"),h=s("./public/app/features/expressions/types.ts");const b={from:21600,to:0},x=(e,t)=>{switch(e.type){case h.Us.classic:return j(e);case h.Us.math:return y(e,t);case h.Us.resample:case h.Us.reduce:return S(e)}},j=e=>{var t;return null===(t=e.conditions)||void 0===t?void 0:t.map(e=>e.query.params[0])},v=(e,t)=>{let s=[],a=[b.to];for(const r of e){const e=t.find(e=>e.refId===r);e&&e.relativeTimeRange&&(s.push(e.relativeTimeRange.from),a.push(e.relativeTimeRange.to))}return{from:s,to:a}},y=(e,t)=>t.filter(t=>{var s;return"query"===t.queryType&&(null===(s=e.expression)||void 0===s?void 0:s.includes(t.refId))}).map(e=>e.refId),S=e=>e.expression?[e.expression]:void 0;function _(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const w=(e,t)=>{const s=R(t,o.LoadingState.Loading),a={data:{data:t},url:"/api/v1/eval",method:"POST",requestId:(0,u.Z)()};return(0,o.withLoadingIndicator)({whileLoading:s,source:e.fetch(a).pipe(z(s),(0,n.K)(e=>(0,r.of)(C(s,e))),(0,f.V)(e,a.requestId),(0,i.B)())})},R=(e,t)=>e.reduce((s,a)=>(s[a.refId]={state:t,series:[],timeRange:k(a,e)},s),{}),k=(e,t)=>{if((0,p.j)(e.model)){const s=((e,t)=>{const s=x(e,t);if(!s)return b;const{from:a,to:r}=v(s,t);return a.length||r.length?{from:Math.max(...a),to:Math.min(...r)}:b})(e.model,t);return o.rangeUtil.relativeToTimeRange(s)}return e.relativeTimeRange?o.rangeUtil.relativeToTimeRange(e.relativeTimeRange):(console.warn(`Query with refId: ${e.refId} did not have any relative time range, using default.`),(0,o.getDefaultTimeRange)())},z=e=>(0,c.U)(t=>{const{data:s}=t,a={};for(const[t,r]of Object.entries(s.results))a[t]={timeRange:e[t].timeRange,state:o.LoadingState.Done,series:r.frames.map(o.dataFrameFromJSON)};return a}),C=(e,t)=>{const s=(0,l.toDataQueryError)(t);return $(e,(e,t)=>Object.assign({},t,{state:o.LoadingState.Error,error:s}))},$=(e,t)=>{const s={};for(const[a,r]of Object.entries(e))s[a]=t(a,r);return s}},"./public/app/features/expressions/guards.ts":(e,t,s)=>{s.d(t,{j:()=>n});var a=s("./packages/grafana-runtime/src/utils/DataSourceWithBackend.ts"),r=s("./public/app/features/expressions/types.ts");const n=e=>{if(!e)return!1;if((0,a.Pr)(e.datasource))return!0;const t=e;return"string"==typeof t.type&&Object.values(r.Us).includes(t.type)}},"./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useObservable.js":(e,t,s)=>{s.d(t,{Z:()=>n});var a=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=s("./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useIsomorphicLayoutEffect.js");const n=function(e,t){var s=(0,a.useState)(t),n=s[0],i=s[1];return(0,r.Z)(function(){var t=e.subscribe(i);return function(){return t.unsubscribe()}},[e]),n}}}]);