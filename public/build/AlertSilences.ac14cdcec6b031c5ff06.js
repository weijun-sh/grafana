"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1783],{"./public/app/core/hooks/useCleanup.ts":(e,a,t)=>{t.d(a,{x:()=>i});var s=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),n=t("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/0/cache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),r=t("./public/app/core/actions/cleanUp.ts");function i(e){const a=(0,n.useDispatch)(),t=(0,s.useRef)(e);t.current=e,(0,s.useEffect)((()=>()=>{a((0,r.e)({stateSelector:t.current}))}),[a])}},"./public/app/features/alerting/unified/Silences.tsx":(e,a,t)=>{t.r(a),t.d(a,{default:()=>Ee});var s,n=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=t("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/0/cache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),i=t("./.yarn/__virtual__/react-router-virtual-31642fe47a/0/cache/react-router-npm-5.2.1-ea754d7473-7daae084bf.zip/node_modules/react-router/esm/react-router.js"),l=t("./packages/grafana-ui/src/index.ts"),c=t("./public/app/features/alerting/unified/components/AlertManagerPicker.tsx"),o=t("./public/app/features/alerting/unified/components/AlertingPageWrapper.tsx"),d=t("./public/app/features/alerting/unified/components/NoAlertManagerWarning.tsx"),u=t("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),p=t("./.yarn/cache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js"),m=t("./.yarn/__virtual__/react-hook-form-virtual-92b6119fd4/0/cache/react-hook-form-npm-7.5.3-f9cc466c62-fbfaa3b664.zip/node_modules/react-hook-form/dist/index.esm.js"),g=t("./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useDebounce.js"),h=t("./packages/grafana-data/src/index.ts"),f=t("./packages/grafana-runtime/src/index.ts"),x=t("./public/app/core/hooks/useCleanup.ts"),b=t("./public/app/plugins/datasource/alertmanager/types.ts"),v=t("./public/app/features/alerting/unified/hooks/useURLSearchParams.ts"),j=t("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts"),y=t("./public/app/features/alerting/unified/state/actions.ts"),S=t("./public/app/features/alerting/unified/utils/alertmanager.ts"),A=t("./public/app/features/alerting/unified/utils/matchers.ts"),_=t("./public/app/features/alerting/unified/utils/misc.ts"),k=t("./public/app/features/alerting/unified/hooks/useCombinedRuleNamespaces.ts"),w=t("./public/app/features/alerting/unified/utils/rules.ts"),N=t("./public/app/features/alerting/unified/components/AlertLabels.tsx"),C=t("./public/app/features/alerting/unified/components/DynamicTable.tsx"),M=t("./public/app/features/alerting/unified/components/rules/AlertStateTag.tsx"),D=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const $=()=>{var e;const[a,t]=(0,n.useState)([]),i=(0,m.Gc)(),c=(0,r.useDispatch)(),{watch:o}=i,d=o("matchers"),u=(0,l.useStyles2)(z),p=[{id:"state",label:"State",renderCell:function(e){let{data:{matchedInstance:a}}=e;return(0,D.jsx)(M.l,{state:a.state})},size:"160px"},{id:"labels",label:"Labels",renderCell:function(e){let{data:{matchedInstance:a}}=e;return(0,D.jsx)(N.s,{labels:a.labels})},size:"250px"},{id:"created",label:"Created",renderCell:function(e){let{data:{matchedInstance:a}}=e;return(0,D.jsx)(D.Fragment,{children:a.activeAt.startsWith("0001")?"-":(0,h.dateTime)(a.activeAt).format("YYYY-MM-DD HH:mm:ss")})},size:"400px"}];(0,n.useEffect)((()=>{c((0,y.ei)())}),[c]);const f=(0,k.Zo)();return(0,g.Z)((()=>{const e=f.flatMap((e=>e.groups.flatMap((e=>e.rules.map((e=>e.promRule)).filter((e=>(0,w.x_)(e))).flatMap((e=>{var a;return(0,A.TZ)(null!==(a=e.alerts)&&void 0!==a?a:[],d)}))))));t(e)}),500,[f,d]),(0,D.jsxs)("div",{children:[(0,D.jsxs)("h4",{className:u.title,children:["Affected alert instances",a.length>0?(0,D.jsx)(l.Badge,{className:u.badge,color:"blue",text:a.length}):null]}),(0,D.jsx)("div",{className:u.table,children:d.every((e=>!e.value&&!e.name))?s||(s=(0,D.jsx)("span",{children:"Add a valid matcher to see affected alerts"})):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(C.t,{items:null!==(e=a.slice(0,5))&&void 0!==e?e:[],isExpandable:!1,cols:p}),a.length>5&&(0,D.jsxs)("div",{className:u.moreMatches,children:["and ",a.length-5," more"]})]})})]})};const z=e=>({table:u.css`
    max-width: ${e.breakpoints.values.lg}px;
  `,moreMatches:u.css`
    margin-top: ${e.spacing(1)};
  `,title:u.css`
    display: flex;
    align-items: center;
  `,badge:u.css`
    margin-left: ${e.spacing(1)};
  `}),R=["onChange","ref"];const T=e=>({wrapper:u.css`
      margin-top: ${e.spacing(2)};
    `,row:u.css`
      display: flex;
      align-items: flex-start;
      flex-direction: row;
      background-color: ${e.colors.background.secondary};
      padding: ${e.spacing(1)} ${e.spacing(1)} 0 ${e.spacing(1)};
      & > * + * {
        margin-left: ${e.spacing(2)};
      }
    `,removeButton:u.css`
      margin-left: ${e.spacing(1)};
      margin-top: ${e.spacing(2.5)};
    `,matcherOptions:u.css`
      min-width: 140px;
    `,matchers:u.css`
      max-width: ${e.breakpoints.values.sm}px;
      margin: ${e.spacing(1)} 0;
      padding-top: ${e.spacing(.5)};
    `}),I=e=>{let{className:a}=e;const t=(0,l.useStyles2)(T),s=(0,m.Gc)(),{control:n,register:r,formState:{errors:i}}=s,{fields:c=[],append:o,remove:d}=(0,m.Dq)({name:"matchers"});return(0,D.jsx)("div",{className:(0,u.cx)(a,t.wrapper),children:(0,D.jsx)(l.Field,{label:"Matching labels",required:!0,children:(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{className:t.matchers,children:c.map(((e,a)=>{var s,o,u,p,m,g,h,f,x,b;return(0,D.jsxs)("div",{className:t.row,"data-testid":"matcher",children:[(0,D.jsx)(l.Field,{label:"Label",invalid:!(null==i||null===(s=i.matchers)||void 0===s||null===(o=s[a])||void 0===o||!o.name),error:null==i||null===(u=i.matchers)||void 0===u||null===(p=u[a])||void 0===p||null===(m=p.name)||void 0===m?void 0:m.message,children:(0,D.jsx)(l.Input,Object.assign({},r(`matchers.${a}.name`,{required:{value:!0,message:"Required."}}),{defaultValue:e.name,placeholder:"label"}))}),(0,D.jsx)(l.Field,{label:"Operator",children:(0,D.jsx)(l.InputControl,{control:n,render:e=>{let{field:{onChange:a}}=e,s=function(e,a){if(null==e)return{};var t,s,n={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e.field,R);return(0,D.jsx)(l.Select,Object.assign({},s,{onChange:e=>a(e.value),className:t.matcherOptions,options:S.tA,"aria-label":"operator"}))},defaultValue:e.operator||S.tA[0].value,name:`matchers.${a}.operator`,rules:{required:{value:!0,message:"Required."}}})}),(0,D.jsx)(l.Field,{label:"Value",invalid:!(null==i||null===(g=i.matchers)||void 0===g||null===(h=g[a])||void 0===h||!h.value),error:null==i||null===(f=i.matchers)||void 0===f||null===(x=f[a])||void 0===x||null===(b=x.value)||void 0===b?void 0:b.message,children:(0,D.jsx)(l.Input,Object.assign({},r(`matchers.${a}.value`,{required:{value:!0,message:"Required."}}),{defaultValue:e.value,placeholder:"value"}))}),c.length>1&&(0,D.jsx)(l.IconButton,{className:t.removeButton,tooltip:"Remove matcher",name:"trash-alt",onClick:()=>d(a),children:"Remove"})]},`${e.id}`)}))}),(0,D.jsx)(l.Button,{type:"button",icon:"plus",variant:"secondary",onClick:()=>{const e={name:"",value:"",operator:b._M.equal};o(e)},children:"Add matcher"})]})})})},O=()=>{const{control:e,getValues:a}=(0,m.Gc)(),t=(0,l.useStyles)(q),{field:{onChange:s,value:n},fieldState:{invalid:r}}=(0,m.bc)({name:"startsAt",control:e,rules:{validate:e=>a().endsAt>e}}),{field:{onChange:i,value:c},fieldState:{invalid:o}}=(0,m.bc)({name:"endsAt",control:e,rules:{validate:e=>a().startsAt<e}}),{field:{onChange:d,value:u}}=(0,m.bc)({name:"timeZone",control:e}),p=r||o,g=(0,h.dateTime)(n),f=(0,h.dateTime)(c);return(0,D.jsx)(l.Field,{className:t.timeRange,label:"Silence start and end",error:p?"To is before or the same as from":"",invalid:p,children:(0,D.jsx)(l.TimeRangeInput,{value:{from:g,to:f,raw:{from:g,to:f}},timeZone:u,onChange:e=>{s((0,h.dateTime)(e.from)),i((0,h.dateTime)(e.to))},onChangeTimeZone:e=>d(e),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"})})},q=e=>({timeRange:u.css`
    width: 400px;
  `});var B,E,Z,F,L;const V=(e,a)=>{const t=new Date;if(a){var s;const e=Date.parse(a.endsAt)<Date.now()?{start:t,end:(0,h.addDurationToDate)(t,{hours:2})}:{start:new Date(a.startsAt),end:new Date(a.endsAt)};return{id:a.id,startsAt:e.start.toISOString(),endsAt:e.end.toISOString(),comment:a.comment,createdBy:a.createdBy,duration:(0,h.intervalToAbbreviatedDurationString)(e),isRegex:!1,matchers:(null===(s=a.matchers)||void 0===s?void 0:s.map(S.cm))||[],matcherName:"",matcherValue:"",timeZone:h.DefaultTimeZone}}{const a=(0,h.addDurationToDate)(t,{hours:2});return Object.assign({id:"",startsAt:t.toISOString(),endsAt:a.toISOString(),comment:`created ${(0,h.dateTime)().format("YYYY-MM-DD HH:mm")}`,createdBy:f.config.bootData.user.name,duration:"2h",isRegex:!1,matchers:[{name:"",value:"",operator:b._M.equal}],matcherName:"",matcherValue:"",timeZone:h.DefaultTimeZone},(e=>{const a={},t=e.get("comment"),s=e.getAll("matcher"),n=(0,A.RT)(s);return n.length&&(a.matchers=n.map(S.cm)),t&&(a.comment=t),a})(e))}},P=e=>({field:u.css`
    margin: ${e.spacing(1,0)};
  `,textArea:u.css`
    max-width: ${e.breakpoints.values.sm}px;
  `,createdBy:u.css`
    width: 200px;
  `,flexRow:u.css`
    display: flex;
    flex-direction: row;
    justify-content: flex-start;

    & > * {
      margin-right: ${e.spacing(1)};
    }
  `,silencePeriod:u.css`
    max-width: ${e.breakpoints.values.sm}px;
  `}),Y=e=>{var a;let{silence:t,alertManagerSourceName:s}=e;const[i]=(0,v.j)(),c=(0,n.useMemo)((()=>V(i,t)),[t,i]),o=(0,m.cI)({defaultValues:c}),d=(0,r.useDispatch)(),f=(0,l.useStyles2)(P),{loading:b}=(0,j._)((e=>e.updateSilence));(0,x.x)((e=>e.unifiedAlerting.updateSilence));const{register:A,handleSubmit:k,formState:w,watch:N,setValue:C,clearErrors:M}=o,z=N("duration"),R=N("startsAt"),T=N("endsAt"),[q,Y]=(0,n.useState)(z);return(0,g.Z)((()=>{if((0,h.isValidDate)(R)&&(0,h.isValidDate)(T))if(z!==q)C("endsAt",(0,h.dateTime)((0,h.addDurationToDate)(new Date(R),(0,h.parseDuration)(z))).toISOString()),Y(z);else{const e=new Date(R).valueOf();if(new Date(T).valueOf()>e){const e=(0,h.intervalToAbbreviatedDurationString)({start:new Date(R),end:new Date(T)});C("duration",e),Y(e)}}}),700,[M,z,T,q,C,R]),(0,D.jsx)(m.RV,Object.assign({},o,{children:(0,D.jsxs)("form",{onSubmit:k((e=>{const{id:a,startsAt:t,endsAt:n,comment:r,createdBy:i,matchers:l}=e,c=l.map(S._J),o=(0,p.pickBy)({id:a,startsAt:t,endsAt:n,comment:r,createdBy:i,matchers:c},(e=>!!e));d((0,y.QY)({alertManagerSourceName:s,payload:o,exitOnSave:!0,successMessage:"Silence "+(o.id?"updated":"created")}))})),children:[(0,D.jsxs)(l.FieldSet,{label:""+(t?"Recreate silence":"Create silence"),children:[(0,D.jsxs)("div",{className:(0,u.cx)(f.flexRow,f.silencePeriod),children:[B||(B=(0,D.jsx)(O,{})),(0,D.jsx)(l.Field,{label:"Duration",invalid:!!w.errors.duration,error:w.errors.duration&&("required"===w.errors.duration.type?"Required field":w.errors.duration.message),children:(0,D.jsx)(l.Input,Object.assign({className:f.createdBy},A("duration",{validate:e=>0===Object.keys((0,h.parseDuration)(e)).length?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),{id:"duration"}))})]}),E||(E=(0,D.jsx)(I,{})),(0,D.jsx)(l.Field,{className:(0,u.cx)(f.field,f.textArea),label:"Comment",required:!0,error:null===(a=w.errors.comment)||void 0===a?void 0:a.message,invalid:!!w.errors.comment,children:(0,D.jsx)(l.TextArea,Object.assign({},A("comment",{required:{value:!0,message:"Required."}}),{rows:5,placeholder:"Details about the silence"}))}),Z||(Z=(0,D.jsx)($,{}))]}),(0,D.jsxs)("div",{className:f.flexRow,children:[b&&(F||(F=(0,D.jsx)(l.Button,{disabled:!0,icon:"fa fa-spinner",variant:"primary",children:"Saving..."}))),!b&&(L||(L=(0,D.jsx)(l.Button,{type:"submit",children:"Submit"}))),(0,D.jsx)(l.LinkButton,{href:(0,_.eQ)("alerting/silences",s),variant:"secondary",fill:"outline",children:"Cancel"})]})]})}))};var Q=t("./.yarn/__virtual__/@grafana-experimental-virtual-22e4fdfd25/0/cache/@grafana-experimental-npm-0.0.2-canary.30-71a280d204-b5b453b937.zip/node_modules/@grafana/experimental/index.js"),U=t("./public/app/core/hooks/useQueryParams.ts"),G=t("./public/app/core/services/context_srv.ts"),H=t("./public/app/features/alerting/unified/utils/access-control.ts"),W=t("./public/app/features/alerting/unified/components/Authorize.tsx"),J=t("./packages/grafana-ui/src/components/Button/index.ts");const K=["className"];const X=e=>{let{className:a}=e,t=function(e,a){if(null==e)return{};var t,s,n={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,K);return(0,D.jsx)(J.zx,Object.assign({variant:"secondary",size:"xs",className:(0,u.cx)((0,l.useStyles)(ee),a)},t))},ee=e=>u.css`
  height: 24px;
  font-size: ${e.typography.size.sm};
`;var ae,te=t("./public/app/features/alerting/unified/components/rules/ActionIcon.tsx"),se=t("./public/app/features/alerting/unified/components/silences/Matchers.tsx"),ne=t("./public/app/core/components/EmptyListCTA/EmptyListCTA.tsx");const re=e=>{let{alertManagerSourceName:a}=e;const t=(0,H.QX)(a);return G.Vt.hasAccess(t.create,G.Vt.isEditor)?(0,D.jsx)(ne.Z,{title:"You haven't created any silences yet",buttonIcon:"bell-slash",buttonLink:(0,_.eQ)("alerting/silence/new",a),buttonTitle:"New silence"}):ae||(ae=(0,D.jsx)(l.CallToActionCard,{callToActionElement:(0,D.jsx)("div",{}),message:"No silences found."}))};var ie,le=t("./public/app/features/alerting/unified/styles/table.ts"),ce=t("./public/app/features/alerting/unified/components/CollapseToggle.tsx"),oe=t("./public/app/features/alerting/unified/components/silences/AmAlertStateTag.tsx");const de=e=>{let{alert:a,className:t}=e;const[s,r]=(0,n.useState)(!0),i=(0,h.intervalToAbbreviatedDurationString)({start:new Date(a.startsAt),end:new Date(a.endsAt)}),l=Object.entries(a.labels).reduce(((e,a)=>{let[t,s]=a;return"alertname"!==t&&"__alert_rule_title__"!==t||(e=s),e}),"");return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("tr",{className:t,children:[(0,D.jsx)("td",{children:(0,D.jsx)(ce.U,{isCollapsed:s,onToggle:e=>r(e)})}),(0,D.jsx)("td",{children:(0,D.jsx)(oe.G,{state:a.status.state})}),(0,D.jsxs)("td",{children:["for ",i," seconds"]}),(0,D.jsx)("td",{children:l})]}),!s&&(0,D.jsxs)("tr",{className:t,children:[ie||(ie=(0,D.jsx)("td",{})),(0,D.jsx)("td",{colSpan:5,children:(0,D.jsx)(N.s,{labels:a.labels})})]})]})};var ue,pe;const me=e=>({tableMargin:u.css`
    margin-bottom: ${e.spacing(1)};
  `,colState:u.css`
    width: 110px;
  `,colName:u.css`
    width: 65%;
  `}),ge=e=>{let{silencedAlerts:a}=e;const t=(0,l.useStyles2)(le.D),s=(0,l.useStyles2)(me);return a.length?(0,D.jsxs)("table",{className:(0,u.cx)(t.table,s.tableMargin),children:[(0,D.jsxs)("colgroup",{children:[(0,D.jsx)("col",{className:t.colExpand}),(0,D.jsx)("col",{className:s.colState}),ue||(ue=(0,D.jsx)("col",{})),(0,D.jsx)("col",{className:s.colName})]}),pe||(pe=(0,D.jsx)("thead",{children:(0,D.jsxs)("tr",{children:[(0,D.jsx)("th",{}),(0,D.jsx)("th",{children:"State"}),(0,D.jsx)("th",{}),(0,D.jsx)("th",{children:"Alert name"})]})})),(0,D.jsx)("tbody",{children:a.map(((e,a)=>(0,D.jsx)(de,{alert:e,className:a%2==0?t.evenRow:""},e.fingerprint)))})]}):null},he=e=>{let{silence:a}=e;const{startsAt:t,endsAt:s,comment:n,createdBy:r,silencedAlerts:i}=a,c=(0,l.useStyles2)(fe),o="YYYY-MM-DD HH:mm",d=h.dateMath.parse(t),u=h.dateMath.parse(s),p=(0,h.intervalToAbbreviatedDurationString)({start:new Date(t),end:new Date(s)});return(0,D.jsxs)("div",{className:c.container,children:[(0,D.jsx)("div",{className:c.title,children:"Comment"}),(0,D.jsx)("div",{children:n}),(0,D.jsx)("div",{className:c.title,children:"Schedule"}),(0,D.jsx)("div",{children:`${null==d?void 0:d.format(o)} - ${null==u?void 0:u.format(o)}`}),(0,D.jsx)("div",{className:c.title,children:"Duration"}),(0,D.jsxs)("div",{children:[" ",p]}),(0,D.jsx)("div",{className:c.title,children:"Created by"}),(0,D.jsxs)("div",{children:[" ",r]}),(0,D.jsx)("div",{className:c.title,children:"Affected alerts"}),(0,D.jsx)(ge,{silencedAlerts:i})]})},fe=e=>({container:u.css`
    display: grid;
    grid-template-columns: 1fr 9fr;
    grid-row-gap: 1rem;
  `,title:u.css`
    color: ${e.colors.text.primary};
  `,row:u.css`
    margin: ${e.spacing(1,0)};
  `});var xe=t("./public/app/features/alerting/unified/components/StateTag.tsx");const be={[b.As.Active]:"good",[b.As.Expired]:"neutral",[b.As.Pending]:"neutral"},ve=e=>{let{state:a}=e;return(0,D.jsx)(xe.i,{state:be[a],children:a})};var je,ye;const Se=Object.entries(b.As).map((e=>{let[a,t]=e;return{label:a,value:t}})),Ae=()=>(0,p.uniqueId)("query-string-"),_e=()=>{const[e,a]=(0,n.useState)(Ae()),[t,s]=(0,U.K)(),{queryString:r,silenceState:i}=(0,_.pF)(t),c=(0,l.useStyles2)(ke),o=(0,p.debounce)((e=>{const a=e.target;s({queryString:a.value||null})}),400),d=!!(r&&r.length>3)&&0===(0,S.Zh)(r).length;return(0,D.jsxs)("div",{className:c.flexRow,children:[(0,D.jsx)(l.Field,{className:c.rowChild,label:je||(je=(0,D.jsx)(l.Label,{children:(0,D.jsxs)(Q.Stack,{gap:.5,children:[(0,D.jsx)("span",{children:"Search by matchers"}),(0,D.jsx)(l.Tooltip,{content:(0,D.jsxs)("div",{children:["Filter silences by matchers using a comma separated list of matchers, ie:",(0,D.jsx)("pre",{children:"severity=critical, instance=~cluster-us-.+"})]}),children:(0,D.jsx)(l.Icon,{name:"info-circle",size:"sm"})})]})})),invalid:d,error:d?"Query must use valid matcher syntax":null,children:(0,D.jsx)(l.Input,{className:c.searchInput,prefix:ye||(ye=(0,D.jsx)(l.Icon,{name:"search"})),onChange:o,defaultValue:null!=r?r:"",placeholder:"Search","data-testid":"search-query-input"},e)}),(0,D.jsx)(l.Field,{className:c.rowChild,label:"State",children:(0,D.jsx)(l.RadioButtonGroup,{options:Se,value:i,onChange:e=>{s({silenceState:e})}})}),(r||i)&&(0,D.jsx)("div",{className:c.rowChild,children:(0,D.jsx)(l.Button,{variant:"secondary",icon:"times",onClick:()=>{s({queryString:null,silenceState:null}),setTimeout((()=>a(Ae())))},children:"Clear filters"})})]})},ke=e=>({searchInput:u.css`
    width: 360px;
  `,flexRow:u.css`
    display: flex;
    flex-direction: row;
    align-items: flex-end;
    padding-bottom: ${e.spacing(2)};
    border-bottom: 1px solid ${e.colors.border.strong};
  `,rowChild:u.css`
    margin-right: ${e.spacing(1)};
    margin-bottom: 0;
    max-height: 52px;
  `,fieldLabel:u.css`
    font-size: 12px;
    font-weight: 500;
  `});var we,Ne,Ce,Me;const De=e=>{const[a]=(0,U.K)();return(0,n.useMemo)((()=>{const{queryString:t,silenceState:s}=(0,_.pF)(a),n=null==a?void 0:a.silenceIds;return e.filter((e=>{if("string"==typeof n){if(!n.split(",").includes(e.id))return!1}if(t){if(!(0,S.Zh)(t).every((a=>{var t;return null===(t=e.matchers)||void 0===t?void 0:t.some((e=>{let{name:t,value:s,isEqual:n,isRegex:r}=e;return a.name===t&&a.value===s&&a.isEqual===n&&a.isRegex===r}))})))return!1}if(s){if(!(e.status.state===s))return!1}return!0}))}),[a,e])},$e=e=>({topButtonContainer:u.css`
    display: flex;
    flex-direction: row;
    justify-content: flex-end;
  `,addNewSilence:u.css`
    margin: ${e.spacing(2,0)};
  `,callout:u.css`
    background-color: ${e.colors.background.secondary};
    border-top: 3px solid ${e.colors.info.border};
    border-radius: 2px;
    height: 62px;
    display: flex;
    flex-direction: row;
    align-items: center;
    margin-top: ${e.spacing(2)};

    & > * {
      margin-left: ${e.spacing(1)};
    }
  `,calloutIcon:u.css`
    color: ${e.colors.info.text};
  `,editButton:u.css`
    margin-left: ${e.spacing(.5)};
  `});const ze=e=>{let{silences:a,alertManagerAlerts:t,alertManagerSourceName:s}=e;const i=(0,l.useStyles2)($e),[c]=(0,U.K)(),o=De(a),d=(0,H.QX)(s),{silenceState:u}=(0,_.pF)(c),p=!!o.length&&(void 0===u||u===b.As.Expired),m=function(e){const a=(0,r.useDispatch)(),t=(0,l.useStyles2)($e),s=(0,H.QX)(e);return(0,n.useMemo)((()=>{const n=t=>{a((0,y.yO)(e,t))},r=[{id:"state",label:"State",renderCell:function(e){let{data:{status:a}}=e;return(0,D.jsx)(ve,{state:a.state})},size:"88px"},{id:"matchers",label:"Matching labels",renderCell:function(e){let{data:{matchers:a}}=e;return(0,D.jsx)(se.g,{matchers:a||[]})},size:9},{id:"alerts",label:"Alerts",renderCell:function(e){let{data:{silencedAlerts:a}}=e;return(0,D.jsx)("span",{"data-testid":"alerts",children:a.length})},size:1},{id:"schedule",label:"Schedule",renderCell:function(e){let{data:{startsAt:a,endsAt:t}}=e;const s=h.dateMath.parse(a),n=h.dateMath.parse(t),r="YYYY-MM-DD HH:mm";return(0,D.jsxs)(D.Fragment,{children:[" ",null==s?void 0:s.format(r)," ","-",Ce||(Ce=(0,D.jsx)("br",{})),null==n?void 0:n.format(r)]})},size:"150px"}];return G.Vt.hasAccess(s.update,G.Vt.isEditor)&&r.push({id:"actions",label:"Actions",renderCell:function(a){let{data:s}=a;return(0,D.jsxs)(Q.Stack,{gap:.5,children:["expired"===s.status.state?(0,D.jsx)(l.Link,{href:(0,_.eQ)(`/alerting/silence/${s.id}/edit`,e),children:Me||(Me=(0,D.jsx)(X,{icon:"sync",children:"Recreate"}))}):(0,D.jsx)(X,{icon:"bell",onClick:()=>n(s.id),children:"Unsilence"}),"expired"!==s.status.state&&(0,D.jsx)(te.A,{className:t.editButton,to:(0,_.eQ)(`/alerting/silence/${s.id}/edit`,e),icon:"pen",tooltip:"edit"})]})},size:"147px"}),r}),[e,a,t,s])}(s),g=(0,n.useMemo)((()=>o.map((e=>{const a=(s=e.id,t.filter((e=>e.status.silencedBy.includes(s))));var s;return{id:e.id,data:Object.assign({},e,{silencedAlerts:a})}}))),[o,t]);return(0,D.jsxs)("div",{"data-testid":"silences-table",children:[!!a.length&&(0,D.jsxs)(D.Fragment,{children:[we||(we=(0,D.jsx)(_e,{})),(0,D.jsx)(W.q,{actions:[d.create],fallback:G.Vt.isEditor,children:(0,D.jsx)("div",{className:i.topButtonContainer,children:(0,D.jsx)(l.Link,{href:(0,_.eQ)("/alerting/silence/new",s),children:(0,D.jsx)(l.Button,{className:i.addNewSilence,icon:"plus",children:"New Silence"})})})}),g.length?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(C.t,{items:g,cols:m,isExpandable:!0,renderExpandedContent:e=>{let{data:a}=e;return(0,D.jsx)(he,{silence:a})}}),p&&(0,D.jsxs)("div",{className:i.callout,children:[(0,D.jsx)(l.Icon,{className:i.calloutIcon,name:"info-circle"}),Ne||(Ne=(0,D.jsx)("span",{children:"Expired silences are automatically deleted after 5 days."}))]})]}):"No matching silences found"]}),!a.length&&(0,D.jsx)(re,{alertManagerSourceName:s})]})};var Re,Te,Ie=t("./public/app/features/alerting/unified/hooks/useAlertManagerSourceName.ts"),Oe=t("./public/app/features/alerting/unified/hooks/useAlertManagerSources.ts"),qe=t("./public/app/features/alerting/unified/utils/constants.ts"),Be=t("./public/app/features/alerting/unified/utils/redux.ts");const Ee=(0,l.withErrorBoundary)((()=>{var e,a;const t=(0,Oe.k)("instance"),[s,u]=(0,Ie.k)(t),p=(0,r.useDispatch)(),m=(0,j._)((e=>e.silences)),g=(0,j._)((e=>e.amAlerts)),h=s?g[s]||Be.oq:void 0,f=(0,i.TH)().pathname.endsWith("/alerting/silences");(0,n.useEffect)((()=>{function e(){s&&(p((0,y.je)(s)),p((0,y.dB)(s)))}e();const a=setInterval((()=>e),qe.cm);return()=>{clearInterval(a)}}),[s,p]);const{result:x,loading:b,error:v}=s&&m[s]||Be.oq,S=(0,n.useCallback)((e=>x&&x.find((a=>a.id===e))),[x]);return s?(0,D.jsxs)(o.J,{pageId:"silences",children:[(0,D.jsx)(c.P,{disabled:!f,current:s,onChange:u,dataSources:t}),v&&!b&&(0,D.jsx)(l.Alert,{severity:"error",title:"Error loading silences",children:v.message||"Unknown error."}),(null==h?void 0:h.error)&&!(null!=h&&h.loading)&&(0,D.jsx)(l.Alert,{severity:"error",title:"Error loading Alertmanager alerts",children:(null===(e=h.error)||void 0===e?void 0:e.message)||"Unknown error."}),b&&(Te||(Te=(0,D.jsx)(l.LoadingPlaceholder,{text:"loading silences..."}))),x&&!v&&(0,D.jsxs)(i.rs,{children:[(0,D.jsx)(i.AW,{exact:!0,path:"/alerting/silences",children:(0,D.jsx)(ze,{silences:x,alertManagerAlerts:null!==(a=null==h?void 0:h.result)&&void 0!==a?a:[],alertManagerSourceName:s})}),(0,D.jsx)(i.AW,{exact:!0,path:"/alerting/silence/new",children:(0,D.jsx)(Y,{alertManagerSourceName:s})}),(0,D.jsx)(i.AW,{exact:!0,path:"/alerting/silence/:id/edit",children:e=>{let{match:a}=e;return(null==a?void 0:a.params.id)&&(0,D.jsx)(Y,{silence:S(a.params.id),alertManagerSourceName:s})}})]})]}):f?(0,D.jsx)(o.J,{pageId:"silences",children:(0,D.jsx)(d.I,{availableAlertManagers:t})}):Re||(Re=(0,D.jsx)(i.l_,{to:"/alerting/silences"}))}),{style:"page"})},"./public/app/features/alerting/unified/components/AlertingPageWrapper.tsx":(e,a,t)=>{t.d(a,{J:()=>l});t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var s=t("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/0/cache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),n=t("./public/app/core/components/Page/Page.tsx"),r=t("./public/app/core/selectors/navModel.ts"),i=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const l=e=>{let{children:a,pageId:t,isLoading:l}=e;const c=(0,r.h)((0,s.useSelector)((e=>e.navIndex)),t);return(0,i.jsx)(n.Z,{navModel:c,children:(0,i.jsx)(n.Z.Contents,{isLoading:l,children:a})})}},"./public/app/features/alerting/unified/components/Authorize.tsx":(e,a,t)=>{t.d(a,{q:()=>r});t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var s=t("./public/app/core/services/context_srv.ts"),n=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const r=e=>{let{actions:a,children:t,fallback:r=!0}=e;return a.some((e=>s.Vt.hasAccess(e,r)))?(0,n.jsx)(n.Fragment,{children:t}):null}},"./public/app/features/alerting/unified/components/NoAlertManagerWarning.tsx":(e,a,t)=>{t.d(a,{I:()=>m});t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var s,n,r,i,l=t("./packages/grafana-ui/src/index.ts"),c=t("./public/app/features/alerting/unified/hooks/useAlertManagerSourceName.ts"),o=t("./public/app/features/alerting/unified/components/AlertManagerPicker.tsx"),d=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const u=()=>s||(s=(0,d.jsx)(l.Alert,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."})),p=()=>n||(n=(0,d.jsx)(l.Alert,{title:"Selected Alertmanager not found. Select a different Alertmanager.",severity:"warning",children:"Selected Alertmanager no longer exists or you may not have permission to access it."})),m=e=>{let{availableAlertManagers:a}=e;const[t,s]=(0,c.k)(a),n=a.length>0;return(0,d.jsx)("div",{children:n?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.P,{onChange:s,dataSources:a}),r||(r=(0,d.jsx)(p,{}))]}):i||(i=(0,d.jsx)(u,{}))})}},"./public/app/features/alerting/unified/components/rules/ActionIcon.tsx":(e,a,t)=>{t.d(a,{A:()=>i});t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var s=t("./packages/grafana-ui/src/index.ts"),n=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const r=["tooltip","icon","to","target","onClick","className","tooltipPlacement"];const i=e=>{let{tooltip:a,icon:t,to:i,target:l,onClick:c,className:o,tooltipPlacement:d="top"}=e,u=function(e,a){if(null==e)return{};var t,s,n={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);const p="string"==typeof a?a:void 0;return(0,n.jsx)(s.Tooltip,{content:a,placement:d,children:i?(0,n.jsx)(s.LinkButton,Object.assign({variant:"secondary",fill:"text",icon:t,href:i,size:"sm",target:l},u,{"aria-label":p})):(0,n.jsx)(s.Button,Object.assign({className:o,variant:"secondary",fill:"text",size:"sm",icon:t,type:"button",onClick:c},u,{"aria-label":p}))})}},"./public/app/features/alerting/unified/components/silences/AmAlertStateTag.tsx":(e,a,t)=>{t.d(a,{G:()=>l});t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var s=t("./public/app/plugins/datasource/alertmanager/types.ts"),n=t("./public/app/features/alerting/unified/components/StateTag.tsx"),r=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const i={[s.Z9.Active]:"bad",[s.Z9.Unprocessed]:"neutral",[s.Z9.Suppressed]:"info"},l=e=>{let{state:a}=e;return(0,r.jsx)(n.i,{state:i[a],children:a})}},"./public/app/features/alerting/unified/components/silences/Matchers.tsx":(e,a,t)=>{t.d(a,{g:()=>l});var s=t("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),n=(t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),t("./packages/grafana-ui/src/index.ts")),r=t("./public/app/features/alerting/unified/utils/alertmanager.ts"),i=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const l=e=>{let{matchers:a}=e;const t=(0,n.useStyles2)(c);return(0,i.jsx)("div",{children:(0,i.jsx)(n.TagList,{className:t.tags,tags:a.map((e=>`${e.name}${(0,r.zy)(e)}${e.value}`))})})},c=()=>({tags:s.css`
    justify-content: flex-start;
  `})},"./public/app/features/alerting/unified/hooks/useAlertManagerSourceName.ts":(e,a,t)=>{t.d(a,{k:()=>c});var s=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),n=t("./public/app/core/hooks/useQueryParams.ts"),r=t("./public/app/core/store.ts"),i=t("./public/app/features/alerting/unified/utils/constants.ts"),l=t("./public/app/features/alerting/unified/utils/datasource.ts");function c(e){const[a,t]=(0,n.K)(),c=function(e){return(0,s.useCallback)((a=>e.map((e=>e.name)).includes(a)),[e])}(e),o=(0,s.useCallback)((e=>{c(e)&&(e===l.GC?(r.Z.delete(i.de),t({[i.c4]:null})):(r.Z.set(i.de,e),t({[i.c4]:e})))}),[t,c]),d=a[i.c4];if(d&&"string"==typeof d)return c(d)?[d,o]:[void 0,o];const u=r.Z.get(i.de);return u&&"string"==typeof u&&c(u)?(o(u),[u,o]):c(l.GC)?[l.GC,o]:[void 0,o]}},"./public/app/features/alerting/unified/hooks/useAlertManagerSources.ts":(e,a,t)=>{t.d(a,{k:()=>r});var s=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),n=t("./public/app/features/alerting/unified/utils/datasource.ts");function r(e){return(0,s.useMemo)((()=>(0,n.LE)(e)),[e])}},"./public/app/features/alerting/unified/hooks/useCombinedRuleNamespaces.ts":(e,a,t)=>{t.d(a,{Kd:()=>c,Zo:()=>l});var s=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),n=t("./public/app/features/alerting/unified/utils/datasource.ts"),r=t("./public/app/features/alerting/unified/utils/rules.ts"),i=t("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts");function l(e){const a=(0,i._)((e=>e.promRules)),t=(0,i._)((e=>e.rulerRules)),l=(0,s.useRef)({}),c=(0,s.useMemo)((()=>{if(e){const a=(0,n.o_)(e);if(!a)throw new Error(`Unknown rules source: ${e}`);return[a]}return(0,n.h_)()}),[e]);return(0,s.useMemo)((()=>c.map((e=>{var s,i;const c=(0,n.jq)(e)?e.name:e,d=null===(s=a[c])||void 0===s?void 0:s.result,u=null===(i=t[c])||void 0===i?void 0:i.result,p=l.current[c];if(p&&p.promRules===d&&p.rulerRules===u)return p.result;const m={};Object.entries(u||{}).forEach((a=>{let[t,s]=a;const n={rulesSource:e,name:t,groups:[]};m[t]=n,function(e,a){e.groups=a.map((a=>{const t={name:a.name,interval:a.interval,source_tenants:a.source_tenants,rules:[]};return t.rules=a.rules.map((a=>function(e,a,t){return(0,r.cG)(e)?{name:e.alert,query:e.expr,labels:e.labels||{},annotations:e.annotations||{},rulerRule:e,namespace:a,group:t}:(0,r.yF)(e)?{name:e.record,query:e.expr,labels:e.labels||{},annotations:{},rulerRule:e,namespace:a,group:t}:{name:e.grafana_alert.title,query:"",labels:e.labels||{},annotations:e.annotations||{},rulerRule:e,namespace:a,group:t}}(a,e,t))),t}))}(n,s)})),null==d||d.forEach((a=>{let{name:t,groups:s}=a;!function(e,a){a.forEach((a=>{var t;let s=e.groups.find((e=>e.name===a.name));s||(s={name:a.name,rules:[]},e.groups.push(s)),(null!==(t=a.rules)&&void 0!==t?t:[]).forEach((a=>{const t=function(e,a,t){var s;if((0,n.HY)(t))return a.rules.find((a=>a.name===e.name));return null!==(s=a.rules.find((a=>!a.promRule&&o(a,e,!0))))&&void 0!==s?s:a.rules.find((a=>!a.promRule&&o(a,e,!1)))}(a,s,e.rulesSource);t?t.promRule=a:s.rules.push(function(e,a,t){return{name:e.name,query:e.query,labels:e.labels||{},annotations:(0,r.x_)(e)&&e.annotations||{},promRule:e,namespace:a,group:t}}(a,e,s))}))}))}(m[t]=m[t]||{rulesSource:e,name:t,groups:[]},s)}));const g=Object.values(m);return l.current[c]={promRules:d,rulerRules:u,result:g},g})).flat()),[a,t,c])}function c(e){return e.map((e=>{const a=Object.assign({},e,{groups:[]});var t;return a.groups.push({name:"default",rules:(t=e.groups.flatMap((e=>e.rules)),t.sort(((e,a)=>e.name.localeCompare(a.name))))}),a}))}function o(e,a){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.name===a.name&&JSON.stringify([t?d(e.query):"",e.labels,e.annotations])===JSON.stringify([t?d(a.query):"",a.labels||{},(0,r.x_)(a)&&a.annotations||{}])}function d(e){return e.length>1&&"("===e[0]&&")"===e[e.length-1]&&(e=e.slice(1,-1)),(e=e.replace(/\s|\n/g,"")).split("").sort().join("")}},"./public/app/features/alerting/unified/hooks/useURLSearchParams.ts":(e,a,t)=>{t.d(a,{j:()=>i});var s=t("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),n=t("./.yarn/__virtual__/react-router-virtual-31642fe47a/0/cache/react-router-npm-5.2.1-ea754d7473-7daae084bf.zip/node_modules/react-router/esm/react-router.js"),r=t("./packages/grafana-runtime/src/index.ts");function i(){const{search:e}=(0,n.TH)();return[(0,s.useMemo)((()=>new URLSearchParams(e)),[e]),(0,s.useCallback)(((e,a)=>{r.locationService.partial(e,a)}),[])]}},"./public/app/features/alerting/unified/styles/table.ts":(e,a,t)=>{t.d(a,{D:()=>n});var s=t("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js");const n=e=>({table:s.css`
    width: 100%;
    border-radius: ${e.shape.borderRadius()};
    border: solid 1px ${e.colors.border.weak};
    background-color: ${e.colors.background.secondary};

    th {
      padding: ${e.spacing(1)};
    }

    td {
      padding: 0 ${e.spacing(1)};
    }

    tr {
      height: 38px;
    }
  `,evenRow:s.css`
    background-color: ${e.colors.background.primary};
  `,colExpand:s.css`
    width: 36px;
  `,actionsCell:s.css`
    text-align: right;
    width: 1%;
    white-space: nowrap;

    & > * + * {
      margin-left: ${e.spacing(.5)};
    }
  `})}}]);